Description: undisclosed security fix for CVE-2017-15566
Author: Tim Wickberg <tim@schedmd.com>
Last-Update: 2017-10-19

diff --git a/src/slurmd/slurmd/req.c b/src/slurmd/slurmd/req.c
index 527e1bae30..6bcaeb8617 100644
--- a/src/slurmd/slurmd/req.c
+++ b/src/slurmd/slurmd/req.c
@@ -5557,10 +5557,8 @@ _build_env(job_env_t *job_env)
 		job_env->spank_job_env_size = 0;
 		job_env->spank_job_env = (char **) NULL;
 	}
-	if (job_env->spank_job_env_size) {
-		env_array_merge_spank(&env,
-				      (const char **) job_env->spank_job_env);
-	}
+	if (job_env->spank_job_env_size)
+		env_array_merge(&env, (const char **) job_env->spank_job_env);
 
 	slurm_mutex_lock(&conf->config_mutex);
 	setenvf(&env, "SLURMD_NODENAME", "%s", conf->node_name);
